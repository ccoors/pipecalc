<!--This file is part of pipecalc.-->

<!--pipecalc is free software: you can redistribute it and/or modify-->
<!--it under the terms of the GNU General Public License as published by-->
<!--the Free Software Foundation, either version 3 of the License, or-->
<!--(at your option) any later version.-->

<!--pipecalc is distributed in the hope that it will be useful,-->
<!--but WITHOUT ANY WARRANTY; without even the implied warranty of-->
<!--MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the-->
<!--GNU General Public License for more details.-->

<!--You should have received a copy of the GNU General Public License-->
<!--along with pipecalc.  If not, see <http://www.gnu.org/licenses/>.-->
<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>WebPipeCalc</title>
    <link rel="stylesheet" href="bower_components/foundation-sites/dist/css/foundation.min.css"/>
    <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="css/style.css"/>

    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
    </script>
    <script>
window.onerror = function error_handler(errorMsg, url, lineNumber) {
    alert("An error occurred. You might try to use a newer/different web browser. The error message can be found in the console.");
    console.log(url + ": " + lineNumber + ": " + errorMsg);
    return false;
}
    </script>
    <script src="bower_components/MathJax/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>
<body>

<div class="reveal" id="help-intonation-number" data-reveal>
    <h1>Intonation number</h1>
    <p>The intonation number in combination with the cutup height determines the character of a pipe. Additionally it
        determines the efficiency of the pipe. At maximum efficiency, the pipe responds the fastest and produces the
        loudest possible tone. It also produces the least overtones. For most pipes this is not that important or even
        bad, but it can be a factor for very large, slow pipes which require a lot of air. This peak of efficiency is
        reached if the intonation number is set to 2.
    </p>

    <p>A principal stop for example would have an intonation number of about 2.5-3.</p>

    <p>Near an intonation number of 3 a pipe will start to overblow easier. This is why thin, long pipes like the
        violins usually have a frein attached to them.</p>

    <button class="close-button" data-close aria-label="Close modal" type="button">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

<div class="reveal" id="help-octave-notation" data-reveal>
    <h1>Pitch notation</h1>
    <p>This tool uses the scientific pitch notation (International Pitch Notation):</p>

    <table class="hover">
        <thead>
        <tr>
            <th>Scientific notation</th>
            <th>Apostrophe notation</th>
            <th>Index notation</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>$\text{C}_{-3}$</td>
            <td>,,,,,$\text{C}$ or $\text{CCCCCC}$</td>
            <td>$\text{C}_5$</td>
        </tr>
        <tr>
            <td>$\text{C}_{-2}$</td>
            <td>,,,,$\text{C}$ or $\text{CCCCC}$</td>
            <td>$\text{C}_4$</td>
        </tr>
        <tr>
            <td>$\text{C}_{-1}$</td>
            <td>,,,$\text{C}$ or $\text{CCCC}$</td>
            <td>$\text{C}_3$</td>
        </tr>
        <tr>
            <td>$\text{C}_0$</td>
            <td>,,$\text{C}$ or $\text{CCC}$</td>
            <td>$\text{C}_2$</td>
        </tr>
        <tr>
            <td>$\text{C}_1$</td>
            <td>,$\text{C}$ or $\text{C}$</td>
            <td>$\text{C}_1$</td>
        </tr>
        <tr>
            <td>$\text{C}_2$</td>
            <td>$\text{C}$</td>
            <td>$\text{C}$</td>
        </tr>
        <tr>
            <td>$\text{C}_{3}$</td>
            <td>$\text{c}$</td>
            <td>$\text{c}$ or $\text{c}^0$</td>
        </tr>
        <tr>
            <td>$\text{C}_{4}$</td>
            <td>$\text{c}'$</td>
            <td>$\text{c}^1$</td>
        </tr>
        <tr>
            <td>$\text{C}_{5}$</td>
            <td>$\text{c}''$</td>
            <td>$\text{c}^2$</td>
        </tr>
        <tr>
            <td>$\text{C}_{6}$</td>
            <td>$\text{c}'''$</td>
            <td>$\text{c}^3$</td>
        </tr>
        <tr>
            <td>...</td>
            <td>...</td>
            <td>...</td>
        </tr>
        </tbody>
    </table>

    $\text{C}_1 = \text{MIDI Note }24 \approx 32.7\text{ Hz}$<br>
    $\text{C}_5 = \text{MIDI Note }72 \approx 523.25\text{ Hz}$

    <button class="close-button" data-close aria-label="Close modal" type="button">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

<div class="large reveal" id="read-me" data-reveal>
    <h1>Read me</h1>
    <h2>Description</h2>
    <p>This tool is based on formulas by Dr. Ing. H. Ising, published in the German Publication "Walcker Hausmitteilung
        Nr. 42" from June 1971. I cannot guarantee the correctness of the calculations performed by this tool. However,
        I can say that I have built a few pipes with the dimensions generated by this tool and they turned out really
        well.</p>

    <p>You can read about the involved math
        <a href="https://cuervo.phoenix.uberspace.de/blog/pipecalc-mathematics/" target="_blank">here</a>.<p>

    <h2>Usage</h2>
    <h3>Input</h3>
    <p>This tool tries to take all relevant factors for labial pipes into account. The default values provided are about
        the average, but you might want to adjust the wind pressure and the temperature at which the pipes will operate.
        In some cases you might also want to adjust the standard pitch. Please note that this tool will perform the
        calculations of the other tone pitches according to the equal scale only at this moment.</p>

    <h3>Output</h3>
    <p>The tool will output a table of all pipes containing a lot of information.</p>
    <table class="hover">
        <thead>
        <tr>
            <th>Column</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><strong>Frequency</strong></td>
            <td>The frequency of the fundamental note played by that pipe.</td>
        </tr>
        <tr>
            <td><strong>Resonator length (theoretical / actual)</strong></td>
            <td>The theoretical length is the uncorrected length of the pipe's resonator. In reality the resonator has
                to be shorter, because thicker pipes generally need to be shorter than thinner pipes. The actual length
                of the pipe's resonator is usually very close to the actual length calculated by this tool.</td>
        </tr>
        <tr>
            <td><strong>Diameter</strong></td>
            <td>The diameter if the pipe is round.</td>
        </tr>
        <tr>
            <td><strong>Cross section</strong></td>
            <td>The cross section of the pipe.</td>
        </tr>
        <tr>
            <td><strong>Cutup height</strong></td>
            <td>The height of the pipe's mouth. Low tolerance! Try to be within &plusmn;0.5mm. Otherwise the pipe will
                sound too quiet or overblow.
            </td>
        </tr>
        <tr>
            <td><strong>Mouth width</strong></td>
            <td>The width of the pipe's mouth. Not that critical, it basically determines the volume of the tone
                generated by the pipe.
            </td>
        </tr>
        <tr>
            <td><strong>Pipe depth</strong></td>
            <td>The depth of the pipe if it is rectangular. Also not that critical as long as the total cross section of
                the pipe doesn't change too much.
            </td>
        </tr>
        <tr>
            <td><strong>Jet thickness</strong></td>
            <td>The width of the pipe's jet. Extremely critical! Very low tolerance! Try to be within at least
                &plusmn;0.1mm as this dramatically determines the sound produced by the pipe.
            </td>
        </tr>
        <tr>
            <td><strong>Air consumption rate</strong></td>
            <td>The amount of cubic meters of air the pipe will use per second. Might be interesting if you need to
                calculate the volume of your bellows.
            </td>
        </tr>
        <tr>
            <td><strong>Sound power</strong></td>
            <td>The power of sound the pipe will generate. The formula for this value was just taken from Isings
                formulas and appears to be somewhat off. It's still given as it might be used to compare the sound
                powers of similar pipes.
            </td>
        </tr>
        </tbody>
    </table>

    <h3>Notes</h3>
    <ul>
        <li>Please don't just take the values the tool gives you and construct your pipes. You should take tolerances
            into account, especially with the resonator length. Make it longer than the <em>Actual resonator length</em>
            to allow tuning the pipe!
        </li>
        <li>Printing the values works best in Chromium-based web browsers.</li>
        <li>If you get a message box about an error and/or can not find the blue <em>Calculate pipe dimensions</em>
            button please try a different web browser.
        </li>
    </ul>

    <h3>Notes about the CAD template</h3>
    <p>
        The CAD template can be used to generate a representation of the pipes calculated by this tool. You can open it
        in <a href="http://www.openscad.org/" target="_blank">OpenSCAD</a>, a free CAD software. You can edit the values
        at the top of the file and change them to the values the tool gives you. You have to specify some parameters
        which are not calculated by this tool, like foot length and tuning slot dimensions. All the parameters are
        commented and should be relatively easy to understand.
    </p>

    <p>
        You can even use the template to 3D print pipes, a few experiments of mine worked pretty well. In that case, set
        <code>print_model</code> to true, as printing the pipes upright is not that great.
    </p>

    <button class="close-button" data-close aria-label="Close modal" type="button">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

<div class="header-area">
    <div class="content grid-container">
        <div class="grid-x grid-margin-x">
            <div class="cell large-12">
                <h1>WebPipeCalc</h1>
                <p>A tool for calculating the dimensions of labial organ pipes.</p>
                <p>
                    <button class="button" data-open="read-me">Read me</button>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="content-area white-bg">
    <div class="content grid-container">
        <div class="grid-x grid-margin-x">
            <div class="cell large-12">
                <fieldset class="fieldset">
                    <legend>Environment</legend>
                    <div class="grid-x">
                        <div class="cell medium-4">
                            <label for="air_temperature">Air temperature</label>
                            <div class="input-group">
                                <input class="input-group-field" type="number" value="20" min="-273"
                                       id="air_temperature">
                                <span class="input-group-label">$^{\circ}\text{C}$</span>
                            </div>
                        </div>
                        <div class="cell medium-4">
                            <label for="air_density">Air density</label>
                            <div class="input-group">
                                <input class="input-group-field" type="number" value="1.2" min="0.05" step="0.05"
                                       id="air_density">
                                <span class="input-group-label">$\frac{\text{kg}}{\text{m}^3}$</span>
                            </div>
                        </div>
                        <div class="cell medium-4">
                            <label for="standard_pitch">A4 frequency</label>
                            <div class="input-group">
                                <input class="input-group-field" type="number" value="440" min="1" step="0.1"
                                       id="standard_pitch">
                                <span class="input-group-label">$\text{Hz}$</span>
                            </div>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="fieldset">
                    <legend>Organ properties</legend>

                    <div class="grid-x">
                        <div class="cell small-8">
                            <label>Wind pressure
                                <input type="number" value="60" min="1" step="0.5" id="pressure">
                            </label>
                        </div>
                        <div class="cell small-4">
                            <label>Unit
                                <select id="pressure_unit">
                                    <option value="mmh2o">mmH2O</option>
                                    <option value="pa">Pa</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="fieldset">
                    <legend>Pipe rank options</legend>

                    <div class="grid-x">
                        <div class="cell medium-2">
                            <label>First octave <a data-open="help-octave-notation">
                                <i class="fa fa-info-circle" aria-hidden="true"></i>
                            </a>
                                <input type="number" value="4" min="-3" max="10" id="first_octave">
                            </label>
                        </div>

                        <div class="cell medium-1"></div>

                        <div class="cell medium-2">
                            <label>Last octave
                                <input type="number" value="6" min="-3" max="10" id="last_octave">
                            </label>
                        </div>

                        <div class="cell medium-auto"></div>
                    </div>

                    <input type="hidden" name="mode" id="mode-input" value="mode-simple">

                    <div class="grid-x">
                        <div class="cell medium-4">
                            <label>Intonation number <a data-open="help-intonation-number">
                                <i class="fa fa-info-circle" aria-hidden="true"></i>
                            </a>
                                <input type="number" value="2" min="0.5" step="0.01" id="intonation_number">
                            </label>
                        </div>

                        <div class="cell medium-4">
                            <label>Mouth to circumference ratio
                                <input type="number" value="0.25" min="0.05" step="0.005" max="0.95" id="mouth_ratio">
                            </label>
                        </div>

                        <div class="cell medium-4">
                            <label>Cutup to mouth width ratio
                                <input type="number" value="0.3" min="0.05" step="0.01" id="cutup_ratio">
                            </label>
                        </div>
                    </div>

                    <label>Distance in halftones to the same pipes in the Normalmensur by Töpfer
                        <input type="number" value="-2" min="-40" max="40" step="0.25" id="tnm_distance">
                    </label>

                    <br>

                    <p class="no-margin-label">Stopped pipes?</p>
                    <div class="switch large">
                        <input class="switch-input" id="stopped" type="checkbox" name="stopped">
                        <label class="switch-paddle" for="stopped">
                            <span class="show-for-sr">Stopped pipes?</span>
                            <span class="switch-active" aria-hidden="true">Yes</span>
                            <span class="switch-inactive" aria-hidden="true">No</span>
                        </label>
                    </div>
                </fieldset>

                <div class="mount-point"></div>
            </div>
        </div>
    </div>

    <div id="output-table"></div>

    <div class="grid-container">
        <div id="output-csv-download"></div>
        <div id="output-pipe-template">
            <a class="button secondary" href="parametric_pipe_template.scad">Download pipe OpenSCAD template</a>
        </div>
    </div>
</div>

<div class="footer-area">
    <div class="grid-container">
        <footer>
            <p><a href="https://github.com/ccoors/pipecalc" target="_blank">pipecalc</a> &mdash; Copyright &copy;
                2018 Christian Friedrich Coors. <a href="COPYING.txt">GPL3 License</a></p>
            <p>This program is free software: you can redistribute it and/or modify
                it under the terms of the GNU General Public License as published by
                the Free Software Foundation, either version 3 of the License, or
                (at your option) any later version.</p>

            <p>This program is distributed in the hope that it will be useful,
                but WITHOUT ANY WARRANTY; without even the implied warranty of
                MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
                GNU General Public License for more details.</p>

            <p>You should have received a copy of the GNU General Public License
                along with this program. If not, see <a href="http://www.gnu.org/licenses/" target="_blank">http://www.gnu.org/licenses/</a>.
            </p>

            <div class="grid-x">
                <div class="cell small-5"><div class="logo html_logo float-right"></div></div>
                <div class="cell small-2"></div>
                <div class="cell small-5"><div class="logo gpl_logo float-left"></div></div>
            </div>

            <span>HTML5 Logo by <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a></span>
        </footer>
    </div>
</div>

<script src="bower_components/jquery/dist/jquery.js"></script>
<script src="bower_components/what-input/dist/what-input.js"></script>
<script src="bower_components/foundation-sites/dist/js/foundation.min.js"></script>
<script>
$(document).foundation();

$("#output-pipe-template").hide();
</script>
<script src="js/app.js"></script>
</body>
</html>
